<div class="widget metronome-widget">
    <h3>Metronome</h3>
    <div class="tempo-display">
        <span class="tempo-value">{{ tempo }}</span>
        <span class="bpm-label">BPM</span>
    </div>

    <div class="controls">
        <div class="time-sig-controls">
            <button class="btn-small" [class.active]="timeSignature === '4/4'"
                (click)="setTimeSignature('4/4')">4/4</button>
            <button class="btn-small" [class.active]="timeSignature === '3/4'"
                (click)="setTimeSignature('3/4')">3/4</button>
            <button class="btn-small" [class.active]="timeSignature === '6/8'"
                (click)="setTimeSignature('6/8')">6/8</button>
        </div>
        <div class="tempo-controls">
            <button class="btn-adjust" (click)="tempo = tempo - 5; updateTempo()">-5</button>
            <input type="range" min="40" max="200" [(ngModel)]="tempo" (change)="updateTempo()">
            <button class="btn-adjust" (click)="tempo = tempo + 5; updateTempo()">+5</button>
        </div>
    </div>

    <div class="beat-indicator">
        <div class="dot" *ngFor="let b of beatsArray" [class.active]="isPlaying && beat === b"></div>
    </div>

    <button class="btn-toggle" [class.playing]="isPlaying" (click)="toggleMetronome()">
        <span class="material-icons">{{ isPlaying ? 'stop' : 'play_arrow' }}</span>
    </button>
</div>